<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>homePage</title>
    <link rel="stylesheet" href="../CSS/homepage.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
          integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
          crossorigin=""/>
    <link rel="stylesheet" href="../CSS/MapStyles.css"/>
    <link rel="stylesheet" href="../CSS/ViewMoreWindowStyle.css"/>
    <link rel="stylesheet" href="../CSS/ToolbarStyle.css">
    <link rel="stylesheet" href="../CSS/mapFilter.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster/dist/MarkerCluster.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster/dist/MarkerCluster.Default.css" />
</head>
<body>
<div id="header"></div>
<div id="body-container">
    <div id="description-container">
        <p id="description">Descubre las condiciones marítimas en tiempo real en las costas de las Islas Canarias.
            Nuestra plataforma interactiva te ofrece información actualizada sobre mareas, oleaje, viento, corrientes y más,
            ideal para pescadores, surfistas, bañistas y amantes del mar.</p>
    </div>
    <div id="map-container">
        <div id="toolbar">
            <hr>
            <img src="../Images/burgerbar.png" id="toolbar-toggle" onclick="toggleToolbar()">
            <hr>
            <div id="toolbar-content">
                <img src="../Images/location.png" class="toolbar-icon" id="btn-location" onclick="showLocation()">
                <img src="../Images/fav.png" class="toolbar-icon" id="btn-fav" onclick="addToFavorites()">
                <img src="../Images/distance.png" class="toolbar-icon" id="btn-distance" onclick="measureDistance()">
                <img src="../Images/zone.png" class="toolbar-icon" id="btn-zone" onclick="defineZone()">
                <img src="../Images/beach.png" class="toolbar-icon" id="btn-beach" onclick="showBeaches()">
            </div>
        </div>

        <div id="map"></div>

        <div id="layer-selector" class="layer-selector">
            <div id="street-thumb" class="layer-option active" title="Vista de calle"></div>
            <div id="satellite-thumb" class="layer-option" title="Vista satélite"></div>
        </div>

        <div class="popup" style="display: none;">
            <div class="popup-content">
                <button class="close-btn" onclick="closePopup()">X</button>
                <div class="popup-header">
                    <h2 id="popup-title">Información de la zona</h2>
                </div>
                <div class="popup-body">
                    <img id="popup-image" src="" alt="Imagen de la zona seleccionada" class="popup-image" style="display: none;">
                    <p><strong>Nombre de la isla:</strong> <span id="popup-island">-</span></p>
                    <p><strong>Zona:</strong> <span id="popup-zone">-</span></p>
                    <p><strong>Información adicional:</strong> <span id="popup-info"></span></p>
                    <table class="weather-table">
                        <thead>
                        <tr>
                            <th>Temperatura</th>
                            <th>Viento</th>
                            <th>Humedad</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr>
                            <td id="temperature-cell">
                                <img id="iconImg" src="../../icons/sunny-clearCloud.png" class="weather-icon">
                                <span id="temperature"></span>
                            </td>
                            <td><span id="wind"></span></td>
                            <td><span id="humidity"></span></td>
                        </tr>
                        </tbody>
                    </table>
                </div>
                <div class="popup-footer">
                    <a id="popup-link" href="#" class="more-info">Ver más</a>
                </div>
            </div>
        </div>
    </div>
    <div id="mapFilter" class="mapFilterContainer"></div>
</div>
<div id="imageContainer">
    <div class="textBlock" data-template="textContainer"></div>
    <div class="textBlock" data-template="textContainer"></div>
    <div class="textBlock" data-template="textContainer"></div>
</div>
<div id="gap"></div>
<div id="footer"></div>
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
        integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
        crossorigin=""></script>
<script src="https://unpkg.com/leaflet.markercluster/dist/leaflet.markercluster.js"></script>
<script src="https://cdn.jsdelivr.net/npm/polyline@1.0.0/lib/polyline.min.js"></script>


<script src="../JS/searcher.js"></script>
<script src="../JS/map.js"></script>

<script>
    function closePopup() {
        document.querySelector('.popup').style.display = 'none';
    }
</script>

<script src="../JS/ToolbarToggle.js"></script>
<script>
    document.addEventListener("DOMContentLoaded", () => {
        const streetThumb = document.getElementById("street-thumb");
        const satelliteThumb = document.getElementById("satellite-thumb");

        if (!streetThumb || !satelliteThumb) return;

        streetThumb.addEventListener("click", () => {
            toggleStreetView();
            setLayerSelectorActive("street-thumb");
        });

        satelliteThumb.addEventListener("click", () => {
            toggleSatelliteView();
            setLayerSelectorActive("satellite-thumb");
        });

        function setLayerSelectorActive(activeId) {
            document.querySelectorAll('.layer-option').forEach(el => {
                el.classList.remove("active");
            });
            const active = document.getElementById(activeId);
            if (active) active.classList.add("active");
        }
    });
</script>

<script src="../JS/mapFilter.js"></script>

<script>
    document.addEventListener('DOMContentLoaded', init);

    function loadTemplate(fileName, element, callback) {
        fetch(fileName)
            .then((res) => {
                if (!res.ok) {
                    throw new Error(`Error cargando ${fileName}: ${res.status}`);
                }
                return res.text();
            })
            .then((text) => {
                element.innerHTML = text;
                if (callback) {
                    callback();
                }
            })
            .catch((error) => {
                console.error("Error al cargar componente:", error);
            });
    }

    function init() {
        loadTemplate('../HTML-components/header.html', document.getElementById('header'), initSearcher);
        loadTemplate('../HTML-components/footer.html', document.getElementById('footer'));
        loadTemplate('../HTML-components/mapFilter.html', document.getElementById('mapFilter'), initFilters);

        // Cargar dinámicamente todos los textBlocks
        document.querySelectorAll('.textBlock').forEach((el) => {
            loadTemplate('../HTML-components/textContainer.html', el);
        });
    }


</script>
</body>
</html>

